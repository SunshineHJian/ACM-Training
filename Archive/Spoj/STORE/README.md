- [POI 1999 仓库管理员 Store−keeper by BYVoid](https://www.byvoid.com/zhs/blog/poi-1999-mag)


## Note
因為只有一個箱子，而且求的是最少的推箱子的次數，所以狀態用箱子的位置加人在箱子的方向表示，狀態空間只有 O(n2)。首先一步 bfs0 求一下初始狀態有哪些，也就是將箱子視作障礙，看四個方向是否可達。之後再 用一個 bfs 推箱子即可，開個滾動的隊列分別紀錄當前層，和下一層的狀態，推箱子時新狀態推入下一層，換位置時新狀態推入當前層，分情況討論即可。

對於換位置時的推發，暴力的話需要再嵌套一層一開始的那個 bfs0 檢查合法性，更好的方法是預處理 點雙聯通分量 直接判斷。具體來說，顯然，若且僅若兩個人位置處在不同的 點雙聯通分量 中，且箱子的位置位於連結這兩個雙聯通分量的割點上時，這兩個狀態不可達。進一步分析發現只要檢查是否處在不同的雙聯通分量即可，如果不同，則此時箱子的位置一定在割點上。這樣我們只需要預處理聯通分量，而不需要紀錄割點，這樣就不需要對割點為根的情況進行額外的判斷，代碼優雅很多。
